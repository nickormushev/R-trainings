}
sum/1000
sum <- 0
for (i in 1:1000) {
x <- rgamma(20, rate = 1, shape = 2)
y <- rnorm(200, mean = 4, sd = 2)
sum <- sum + t.test(x, y)$p.value > 0.05
}
sum/1000
sum <- 0
for (i in 1:1000) {
x <- rgamma(20, rate = 1, shape = 2)
y <- rnorm(200, mean = 4, sd = 2)
sum <- sum + t.test(x, y)$p.value > 0.05
}
sum/1000
sum <- 0
for (i in 1:1000) {
x <- rgamma(20, rate = 1, shape = 2)
y <- rnorm(200, mean = 4, sd = 2)
sum <- sum + t.test(x, y)$p.value > 0.05
}
sum/1000
sum <- 0
for (i in 1:1000) {
x <- rgamma(20, rate = 1, shape = 2)
y <- rnorm(200, mean = 4, sd = 2)
sum <- sum + t.test(x, y)$p.value > 0.05
}
sum/1000
sample(100)
hist(sample(100, replace = F))
hist(sample(100, replace = F))
hist(sample(100, replace = F))
hist(sample(100, replace = F))
deaths <- c(125,410,310,300,318,298,148)
chisq.test(deaths)
?chisq.test
pi2000
library("UsingR")
pi2000
pi2000[1:200]
pi200 <- pi2000[1:200]
chisq.test(pi200)
chisq.test(table(pi200))
text <- c(102,108,90,95,82,40)
chisq.test(text, p = c(0.127, 0.956, 0.817, 0.751, 0.697, 0.675))
chisq.test(text, p = c(0.127, 0.956, 0.817, 0.751, 0.697, 0.675, 0.4834))
text <- c(102,108,90,95,82,40,519)
chisq.test(text, p = c(0.127, 0.956, 0.817, 0.751, 0.697, 0.675, 0.4834))
chisq.test(text, p = c(0.127, 0.0956, 0.0817, 0.0751, 0.0697, 0.0675, 0.4834))
x <- c(12813,647,359,42)
y <- c(65963,4000,2642,303)
chisq.test(x, y)
x <- append(x, c(65963,4000,2642,303))
m = matrix( x, nrow = 2, byrow = T)
m <- matrix( x, nrow = 2, byrow = T)
chisq.test(m)
chisq.test(x, y)
chisq.test(m)
chisq.test(m[1,], m[2,])
chisq.test(m[1,], m[2, ])
chisq.test(m[1,], m[2, ])
chisq.test(m[1,], m[2, ], simulate.p.value = T)
chisq.test(m[1,], m[2, ])
library("MASS")
anorexia
colnames(anorexia)
?anorexia
library(tidyverse)
anorexia[-c(-3, -5, -7), ]
anorexia[-c(3, 5, 7), ]
order(anorexia$Postwt - anorexia$Prewt)
anorexia[order(anorexia$Postwt - anorexia$Prewt), ]
anorexia[order(anorexia$Postwt - anorexia$Prewt), ][1]
head(anorexia[order(anorexia$Postwt - anorexia$Prewt), ], 1)
an <- anorexia[-c(3, 5, 7), ]
head(an[order(an$Postwt - an$Prewt), ], 1)
an[order(an$Postwt - an$Prewt), ] %>%
head(1)
anorexia %>%
mutate(diff = Postwt - Prewt)
anorexia %>%
mutate(diff = Postwt - Prewt) %>%
arrange(desc(diff))
an[order(an$Postwt - an$Prewt), ] %>%
head(1)
anorexia[order(anorexia$Postwt - anorexia$Prewt), ] %>%
head(1)
anorexia %>%
mutate(diff = Postwt - Prewt) %>%
arrange(desc(diff))
anorexia %>%
mutate(diff = Postwt - Prewt) %>%
arrange(desc(diff)) %>%
head(1)
anorexia[order(anorexia$Postwt - anorexia$Prewt), ] %>%
head(1)
anorexia[order(anorexia$Postwt - anorexia$Prewt, desc = T), ] %>%
head(1)
?order
?order
anorexia[order(anorexia$Postwt - anorexia$Prewt, decreasing = T), ] %>%
head(1)
anorexia %>%
mutate(diff = Postwt - Prewt) %>%
arrange(desc(diff)) %>%
head(1)
anorexia
?group
?group_by
anorexia %>%
group_by(Treat)
anorexia %>%
group_by(Treat) %>%
group_map(~.mean(x$Postwt - x$Prewt))
anorexia %>%
group_by(Treat) %>%
group_map(~mean(.x$Postwt - .x$Prewt))
anorexia %>%
group_by(Treat) %>%
group_map(~mean(.x$Postwt - .x$Prewt)) %>% ungroup()
anorexia %>%
group_by(Treat) %>%
group_map(~mean(.x$Postwt - .x$Prewt)) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Treat, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Treat, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
anorexia %>%
group_by(Treat)
anorexia %>%
group_by(Treat)
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x[0]$Treat, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x[0,]$Treat, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Treat, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Prewt, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Treat, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Treat[0], mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~mean(.x$Postwt - .x$Prewt)) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Treat, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(, mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~c(.x$Prewt[0], mean(.x$Postwt - .x$Prewt))) %>% unlist()
anorexia %>%
group_by(Treat) %>%
group_map(~mean(.x$Postwt - .x$Prewt)) %>% unlist()
anorexia %>%
group_by(Treat)
anorexia %>%
group_by(Treat) %>%
group_map(~mean(.x$Postwt - .x$Prewt)) %>% unlist()
?summarise
anorexia %>%
group_by(Treat) %>%
summarise()
anorexia %>%
group_by(Treat) %>%
summarise(mn = mean(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
#summarise(mn = mean(Postwt - Prewt))
group_map(~mean(.x$Postwt - .x$Prewt)) %>% unlist()
anorexia %>%
group_by(Treat) %>%
summarise(mn = mean(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
summarise(mn = quantile(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
summarise(mn = sd(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
summarise(sd = sd(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
summarise(sd = median(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
summarise(md = median(Postwt - Prewt), qs = quantile(Postwt - Prewt),
mn = mean(Postwt, Prewt), sd = sd(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
summarise(md = median(Postwt - Prewt), qs = quantile(Postwt - Prewt),
mn = mean(Postwt - Prewt), sd = sd(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
plot()
anorexia %>%
group_by(Treat) %>%
plot( type = "l")
?plot
library(ggplot2)
?ggplot2
anorexia %>%
group_by(Treat) %>%
ggplot2()
anorexia %>%
group_by(Treat) %>%
ggplot()
?ggplot
anorexia %>%
group_by(Treat) %>%
ggplot(aex(Treat, Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
ggplot(aes(Treat, Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
barplot()
control <- (anorexia$Postwt - anorexia$Prewt)[anorexia$Treat == "Cont"]
cbt <- (anorexia$Postwt - anorexia$Prewt)[anorexia$Treat == "CBT"]
ft <- (anorexia$Postwt - anorexia$Prewt)[anorexia$Treat == "FT"]
plot(density(control, na.rm = TRUE), xlim = c(-20, 30), ylim = c(0, 0.5), col = "red")
lines(density(cbt, na.rm = TRUE), col = "blue")
lines(density(ft, na.rm = TRUE), col = "green")
boxplot(anorexia$Postwt - anorexia$Prewt ~ anorexia$Treat)
anorexia %>%
ggplot(mapping = aex(x = Prostwt - Prewt, fill = Treat))
anorexia %>%
ggplot(mapping = aex(x = Postwt - Prewt, fill = Treat))
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat))
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat)) +
geom_density(alpha(0.5))
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat)) +
geom_density(alpha = 0.5)
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat)) +
geom_boxplot(alpha = 0.5)
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat)) +
geom_box(alpha = 0.5)
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat)) +
geom_box(alpha = 0.5)
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat)) +
geom_density(alpha = 0.5)
anorexia %>%
ggplot(mapping = aes(x = Postwt - Prewt, fill = Treat)) +
geom_boxplot(alpha = 0.5)
anorexia %>%
ggplot(mapping = aes(x = Prewt, y = Postwt, fill = Treat)) +
geom_point(alpha = 0.5)
?quantile
anCBT <- anorexia[anorexia$Treat == CBT, ]
anCBT <- anorexia[anorexia$Treat == CBT, ]
anCBT <- anorexia[anorexia$Treat == "CBT", ]
anCBT <- anorexia[anorexia$Treat == "CBT", ]
quantile(anCBT$Postwt - anCBT$Prewt, c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1))
anorexia %>%
ggplot(mapping = aes(x = Prewt, y = Postwt, fill = Treat)) +
geom_point(alpha = 0.5)
anorexia %>%
ggplot(mapping = aes(x = Prewt, y = Postwt, color = Treat)) +
geom_point(alpha = 0.5)
anorexia %>%
group_by(Treat) %>%
summarise(normal = shapiro.test(Postwt - Prewt))
anorexia %>%
group_by(Treat) %>%
shapiro.test()
anorexia %>%
group_by(Treat) %>%
shapiro.test(~.x$Postwt - .x$Prewt)
anCBT <- anorexia[anorexia$Treat == "CBT", ]
anFT <- anorexia[anorexia$Treat == "FT", ]
anorexia$Treat
anCBT <- anorexia[anorexia$Treat == "CBT", ]
anFT <- anorexia[anorexia$Treat == "FT", ]
anCont <- anorexia[anorexia$Treat == "Cont", ]
shapiro.test(anCBT$Postwt - anCBT$Prewt)
shapiro.test(anFT$Postwt - anFT$Prewt)
shapiro.test(anCont$Postwt - anCont$Prewt)
shapiro.test(anCBT$Postwt - anCBT$Prewt)
?anorexia
shapiro.test(anCBT$Postwt - anCBT$Prewt)
shapiro.test(anCont$Postwt - anCont$Prewt)
t.test(anFT$Postwt, anCont$Postwt)
t.test(anFT$Postwt, anCont$Postwt, alternative = "less")
t.test(anFT$Postwt, anCont$Postwt, alternative = "less")
wilcox.test(anCBT$Postwt, anCont$Postwt, alternative = "less")
wilcox.test(anCBT$Postwt, anCont$Postwt, alternative = "less")
anorexia %>%
mutate(diff = Postwt - Prewt) %>%
arrange(desc(diff)) %>%
?an
anorexia %>%
mutate(diff = Postwt - Prewt) %>%
arrange(desc(diff))
t.test(anFT$Postwt - anFT$Prewt, anCont$Postwt - anFT$Prewt, alternative = "less")
t.test(anFT$Postwt - anFT$Prewt, anCont$Postwt - anFT$Prewt, alternative = "two.sided")
anorexia
anorexia %>%
lm()
lm(anorexia$Treat ~ anorexia$Postwt - anorexia$Prewt) %>%
anova()
lm(anorexia$Treat ~ anorexia$Postwt - anorexia$Prewt)
lm(anorexia$Treat ~ (anorexia$Postwt - anorexia$Prewt)) %>%
anova()
anorexia$diff <- anorexia$Postwt - anorexia$Prewt
lm(Treat ~ diff, anorexia)
lm(Treat ~ diff, anorexia) %>%
anova()
lm(anorexia)
anorexia$diff
lm(anorexia) %>%
anova()
lm(anorexia) %>%
anova()
?anova
lm(anorexia) %>%
anova()
lm(anorexia)
lm(anorexia$Treat ~ anorexia$diff)
anorexia %>%
stack()
anorexia
anorexia %>%
lm()
anorexia %>%
lm()
anorexia %>%
group_by(Treat) %>%
lm()
anorexia %>%
group_by(Treat) %>%
group_map(~lm(.x))
lm(anorexia$Treat ~ anorexia$diff) %>%
anova()
lm(anorexia$Treat ~ anorexia$diff)
lm(anorexia$Treat ~ anorexia$diff) %>%
anova()
lm(anorexia)
test <- cbind(anorexia$Treat, anorexia$diff)
lm(test)
lm(test)
test <- cbind(anorexia$Treat, anorexia$diff)
lm(test$Treat, test$diff)
lm(test[,1], test[, 2])
test <- cbind(anorexia$Treat, anorexia$diff)
lm(test[,1], test[, 2])
data.frame({
diff = anorexia$diff,
treat = anorexia$Treat
})
data.frame(
diff = anorexia$diff,
treat = anorexia$Treat
)
df <- data.frame(
diff = anorexia$diff,
treat = anorexia$Treat
)
lm(df)
lm(df) %>%
anova()
kruskal.test(diff ~ Treat, anorexia)
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
rev(sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2)))
rev(sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2)))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = F, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
dice <- sample(1:6, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
dice
dice
dice
sample(1:6, 1000, replace = T, prob = c(1/10, 1/10, 1/10, 1/10, 1/10, 1/2))
sample(1:6, 50, replace = T)
dice <- sample(1:6, 50, replace = T)
table(dice)
prop.table(table(dice))
1:1000 %>%
map(~throw())
throw <- function() {
dice <- sample(1:6, 50, replace = T)
}
1:1000 %>%
map(~throw())
1:1000 %>%
map(function(x) {
t <- sum(throw() == 6)
t >= 10 & t <= 20
})
1:1000 %>%
map(function(x) {
t <- sum(throw() == 6)
t >= 10 & t <= 20
}) %>% unlist()
1:1000 %>%
map(function(x) {
t <- sum(throw() == 6)
t >= 10 & t <= 20
}) %>% unlist()
%>% sum()
1:1000 %>%
map(function(x) {
t <- sum(throw() == 6)
t >= 10 & t <= 20
}) %>% unlist() %>%
sum()
1:1000 %>%
map(function(x) {
t <- sum(throw() == 6)
t >= 10 & t <= 20
}) %>% unlist() %>%
sum()/1000
1:1000 %>%
map(function(x) {
t <- sum(throw() == 6)
t >= 10 & t <= 20
}) %>% unlist() %>%
sum()/1000
1:1000 %>%
map(function(x) {
t <- sum(throw() == 6)
t >= 10 & t <= 20
}) %>% unlist() %>%
sum()/1000
pbinom(20, 50, prob = 1/6)
?pbinom
pbinom(20, 50, prob = 1/6) - pbinom(10, 50, prob = 1/6)
pbinom(20, 50, prob = 1/6)
pbinom(20, 50, prob = 1/6)
pbinom(20, 50, prob = 1/6) - pbinom(10, 50, prob = 1/6)
qbinom(0.5, 50, prob = 1/6)
qbinom(0.5, 50, prob = 1/6)
qbinom(0.5, 50, prob = 1/6)
qbinom(0.5, 50, prob = 1/6)
qbinom(0.5, 50, prob = 1/6, lower.tail = F)
qbinom(0.5, 30, prob = 1/6)
qbinom(0.5, 30, prob = 1/6)
?qbinom
qbinom(0.5, 30, prob = 1/6, lower.tail = F)
qbinom(0.5, 30, prob = 1/6, lower.tail = F)
qbinom(0.5, 30, prob = 1/6, lower.tail = F)
rpois(1000, 4)
data <- rpois(1000, 4)
barplot(data)
data <- rpois(1000, 4)
barplot(data)
dpois(1:11)
dpois(1:11, 4)
table(data)
prop.table(table(data))
dpois(1:14, 4)
barplot(prop.table(table(data)))
barplot(dpois(1:14, 4))
barplot(prop.table(table(data)))
split.screen(c(1, 2))
select(1)
barplot(prop.table(table(data)))
select(2)
screen(2)
barplot(dpois(1:14, 4))
?dnbinom
dnbinom(5, 3, prob = 0.2)
pnbinom(4, 3, prob = 1/8, lower.tail = F)
pexp(10, rate = 1/5)
pchisq(q = 2, df = 10)
pchisq(q = 20, df = 10) - pchisq(q = 10, df = 10)
qchisq(p = 0.75, lower.tail = F)
qchisq(p = 0.75, df = 10, lower.tail = F)
?qhyper
dhyper(5, 20, 280, 30)
sum(dhyper(5:10, 20, 280, 30))
